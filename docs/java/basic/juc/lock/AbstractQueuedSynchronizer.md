# AbstractQueuedSynchronizer

`AbstractQueuedSynchronizer`ï¼ˆç®€ç§° **AQS**ï¼‰æ˜¯ Java å¹¶å‘åŒ… `java.util.concurrent.locks` çš„æ ¸å¿ƒæ¡†æ¶ä¹‹ä¸€ï¼Œ
ç”¨äº**æ„å»ºé”å’ŒåŒæ­¥å™¨çš„åŸºç¡€æ¡†æ¶**ï¼Œä¾‹å¦‚ï¼š

- `ReentrantLock`
- `CountDownLatch`
- `Semaphore`
- `ReentrantReadWriteLock`
- `FutureTask`  
  è¿™äº›ç±»çš„åº•å±‚å‡ ä¹éƒ½åŸºäº AQS å®ç°ã€‚

---
> AQS æ˜¯ä¸€ä¸ªâ€œåŒæ­¥çŠ¶æ€ç®¡ç†å™¨â€ï¼Œé€šè¿‡ä¸€ä¸ª **FIFO ç­‰å¾…é˜Ÿåˆ—** å’Œä¸€ä¸ª **state çŠ¶æ€å˜é‡**ï¼Œè®©çº¿ç¨‹å®‰å…¨ã€æœ‰åºåœ°è·å–æˆ–é‡Šæ”¾èµ„æºã€‚
---

##  AQS çš„æ ¸å¿ƒåŸç†

### 1. **æ ¸å¿ƒæˆå‘˜å˜é‡**

```java
public abstract class AbstractQueuedSynchronizer
        extends AbstractOwnableSynchronizer
        implements java.io.Serializable {

    private transient volatile Node head;
    private transient volatile Node tail;
    private volatile int state;
}
```

- `state`: è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼ˆä¾‹å¦‚æ˜¯å¦è¢«é”ä½ã€å‰©ä½™è®¸å¯æ•°ç­‰ï¼‰ï¼Œé€šè¿‡ `getState()/setState()/compareAndSetState()` æ“ä½œã€‚
- `head/tail`: è¡¨ç¤ºä¸€ä¸ª **ç­‰å¾…è·å–é”çš„çº¿ç¨‹é˜Ÿåˆ—ï¼ˆFIFOï¼‰**ã€‚

---

### 2. **ä¸¤ç§æ¨¡å¼**

| æ¨¡å¼   | ç”¨é€”                 | æ–¹æ³•                                          |
|------|--------------------|---------------------------------------------|
| ç‹¬å æ¨¡å¼ | ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼ˆå¦‚ Lockï¼‰     | `tryAcquire()` / `tryRelease()`             |
| å…±äº«æ¨¡å¼ | å¤šçº¿ç¨‹å…±äº«ï¼ˆå¦‚ Semaphoreï¼‰ | `tryAcquireShared()` / `tryReleaseShared()` |

---

### 3. **è‡ªå®šä¹‰åŒæ­¥å™¨çš„å…¸å‹å†™æ³•**

è¦ä½¿ç”¨ AQSï¼Œé€šå¸¸è¦**ç»§æ‰¿ AQS å¹¶é‡å†™å…¶æ–¹æ³•**ï¼Œä¾‹å¦‚ï¼š

---

##  AQS çš„è®¾è®¡ä¼˜åŠ¿

- ğŸ” æ”¯æŒå…±äº«å’Œç‹¬å ä¸¤ç§èµ„æºè®¿é—®æ¨¡å¼ï¼›
- âš™ï¸ æä¾›é˜»å¡é˜Ÿåˆ—ã€çŠ¶æ€ç®¡ç†ã€çº¿ç¨‹ä¸­æ–­ç­‰æœºåˆ¶ï¼›
- ğŸ“¦ é¿å…é‡å¤é€ è½®å­ï¼Œè®©å¼€å‘è€…ä¸“æ³¨å®ç°æ ¸å¿ƒé€»è¾‘ã€‚

---

## ğŸ§© åº”ç”¨ä¸¾ä¾‹

| åŒæ­¥å™¨/ç±»                    | AQS å®ç°æ–¹å¼     |
|--------------------------|--------------|
| `ReentrantLock`          | ç‹¬å æ¨¡å¼         |
| `Semaphore`              | å…±äº«æ¨¡å¼         |
| `CountDownLatch`         | å…±äº«æ¨¡å¼ï¼Œè®¡æ•°ä¸º0æ—¶é‡Šæ”¾ |
| `ReentrantReadWriteLock` | ç‹¬å +å…±äº«        |
| `FutureTask`             | çŠ¶æ€ç®¡ç†+æ’é˜Ÿ      |

---

## âœ… æ€»ç»“

| æ¦‚å¿µ   | å†…å®¹æè¿°                                  |
|------|---------------------------------------|
| æœ¬è´¨   | åŸºäºä¸€ä¸ª int çŠ¶æ€å€¼ + FIFO é˜Ÿåˆ—æ„å»ºåŒæ­¥å™¨           |
| ä½¿ç”¨æ–¹å¼ | ç»§æ‰¿å¹¶å®ç° `tryAcquire` / `tryRelease` ç­‰æ–¹æ³• |
| æ”¯æŒæ¨¡å¼ | ç‹¬å ã€å…±äº«                                 |
| åº”ç”¨åœºæ™¯ | æ„å»ºå„ç§é”ã€ä¿¡å·é‡ã€åŒæ­¥å™¨çš„åŸºç¡€å·¥å…·                    |

---
